# SearchEngine

Программа осушествляет поиск в документах по запросам и выдаёт релевантные ответы.

## Описание

В организациях бывает потребность поиска информации по базе документов. Программе указываются в файлах JSON пути документов и запросы. По документам строится база инвертированного индекса, на основе которого определяется релевантность ответа (содержимого документа) для каждого запроса. По завершении поиска результаты выводятся в файл JSON, где для каждого запроса указан документ со степенью релевантности.\
\
В проекте использована многопоточная обработка (использована стандартная библиотека), - где необходимо. Использована сторонняя библиотека для работы с форматом JSON - [nlohmann/json](https://github.com/nlohmann/json/blob/develop/README.md). Использована сторонняя библиотека для межпроцессного обмена данными с помощью очереди сообщений - [boost/interprocess/ipc/message_queue](https://www.boost.org/doc/libs/master/doc/html/interprocess/synchronization_mechanisms.html#interprocess.synchronization_mechanisms.message_queue).
Проект может быть использован в виде готовой программы (консольного типа) или как библиотека. Архитектура и подробное описание классов приводится в [документации](./docs/ru/index.md).

## Зависимости

Программа была разработана на С++ версии 17 и протестирована на ОС MS Windows 10, MS Windows 11. Для интеграции библиотек в проект можно воспользоваться следующими ссылками:
- библиотека [nlohmann/json](https://github.com/nlohmann/json/#integration) для работы с JSON-форматом;
- библиотека  [boost/interprocess/ipc/message_queue](https://www.boost.org/doc/libs/1_88_0/more/getting_started/windows.html).

Для запуска программы (скаченной из репозитория релиза) не требуется устанавливать дополнительные компоненты. Программа скомпилирована с необходимыми статическими библиотеками. 

## Установка

Для использования проекта можно склонировать репозиторий или вручную добавить библиотеки.\
В проекте использованы три цели: 
- основной проект (search_engine), - основная программа поиска слов в документах и рассчёта релевантности ответов,
- два независимых подпроекта:
  - тесты (search_engine_test), - тесты основных функций,
  - монитор (search_engine_monitor), - консоль вывода сообщений работы основной программы.

Все необходимые файлы (документация, заголовочные, реализации, конфигурации, запросов, ответов, тестовых) находятся в директориях:
- docs - документация к проекту,
- include - заголовочные файлы,
- monitor - файлы реализации вывода сообщений на консоль (независимый подпроект),
- nlohmann_json - файлы библиотеки для работы с JSON-форматом,
- resources - файлы конфигурации, запросов, ответов, тестовых,
- src - исходные файлы,
- tests - файлы заголовков, реализации, тестирования (независимый подпроект).

Файлы CMakeList.txt находятся в директориях:
- monitor,
- src,
- tests,
- "корень репозитория".

Для работы с исходными файлами проекта небходимо:
1. Скопировать файлы config.json, logger.json, requests.json (конфигурации и запросов) из репозитория директории "resources" в директорию с исполняемым файлом основоного проекта search-engine.exe.
2. Скопировать файл search_engine_monitor.exe из директории подпроекта "search_engine_monitor" в директорию с исполняемым файлом проекта search-engine.exe.
3. Скопировать директорию "resources" из репозитория директории "resources" в директорию с исполняемым файлом search-engine.exe. В этой директории находятся три документа для примера, по которым осуществляется поиск.
4. Подключить библиотеку [nlohmann/json](https://github.com/nlohmann/json/#integration) (в проекте это уже сделано).
5. Подключить библиотеку [boost/interprocess/ipc/message_queue](https://www.boost.org/doc/libs/1_88_0/more/getting_started/windows.html) самостоятельно.
6. Подключить библиотеку юнит-тестирования [GoogleTest](https://github.com/google/googletest/blob/main/googletest/README.md) (в проекте это уже сделано).

Чтобы использовать готовую программу:
- можно скачать релиз (уже содержит все необходимые файлы);
- или скомпилировать из своего проекта (основной проект - search_engine, подпроект - search_engine_monitor). Обратите внимание, что необходимо так же скопировать файлы config.json, logger.json, requests.json (конфигурации и запросов) и директорию "resources" из репозитория директории "resources", и файл search_engine_monitor.exe из директории подпроекта "search_engine_monitor", в директорию с исполняемым файлом search-engine.exe.

То есть, в любом случае вы получаете начальную готовую структуру для немедленного применения.

## Как использовать проект

Программа использует файлы конфигурации и запросов (config.json, logger.json и requests.json). По результатам поиска в документах по запросам формируется файл answers.json, находящийся по этому же пути.\
Файл config.json:
```json
{
  "config": {
    "name": "SearchEngine",
    "version": "1.0.0",
    "max_responses": 5
  },
  "files": [
    "../../resources/file001.txt",
    "../../resources/file002.txt",
    "../../resources/file003.txt"
  ]
}
```
В поле "files" прописываются пути до файлов документов. В поле "max_responses" указывается максимальное количество ответов (количество документов для каждого запроса). Назначение других полей очевидно.
\
Файл requests.json:
```json
{
  "requests": [
    "of the and water is year",
    "water another good see",
    "music"
  ]
}
```
В поле "requests" прописываются сами запросы; по ним будет вестись поиск в документах.\
Файл answers.json:
```json
{
  "answers": {
    "request001": {
      "result": "true",
      "relevance": [
        {
          "docid": 0,
          "rank": 1.0
        },
        {
          "docid": 2,
          "rank": 0.94737
        }
      ]
    },
    "request002": {
      "result": "true",
        "docid": 0,
        "rank": 0.03509
      },
    "request003": {
      "result": "false"
    }
  }
}
```
В этом файле для каждого запроса приводятся ID документов со значением релевантности ответа.

### Программа

Для запуска программы надо просто запустить файл search_engine.exe без ключей.\
Для работы необходимо, чтобы файлы конфигурации и запросов (config.json и requests.json) находились в директории с программой. В этой же директории по окончании поиска будет создан файл ответов (answers.json).

### Библиотека

Для использования в самой программе (в функции main) необходимо оперировать объектом класса SearchEngine. Он уже в свою очередь управляет взаимодействием между другими классами.\
Есть следующие функции рассчёта релевантности:
1. Рассчитать релевантность ответов (изменяются документы и запросы)
2. Рассчитать релевантность ответов, при изменении документов (изменяются только документы)
3. Рассчитать релевантность ответов, при изменении запросов (изменяются только запросы)

Пример:
```cpp
SearchEngine searchEngine(ReadWriteJSONFile().readJSONFile(constants::configFilePath),
                              ReadWriteJSONFile().readJSONFile(constants::requestsFilePath));

//...
//Меняются документы и запросы
//...

//Рассчитать релевантность ответов (изменяются документы и запросы)
searchEngine.searchModifiedAll();

//...
//Меняются документы
//...

//Рассчитать релевантность ответов, при изменении документов (изменяются только документы)
searchEngine.searchModifiedDocuments();

//...
//Меняются запросы
//...

//Рассчитать релевантность ответов, при изменении запросов (изменяются только запросы)
searchEngine.searchModifiedRequests();
```

## Тестирование

В проекте использована система юнит-тестирования [GoogleTest](https://github.com/google/googletest); реализована как независимый подпроект, - в репозитории в директории "tests" имеются исходные тесты. С помощью них тестируются основные классы, а именно: логика рассчёта релевантности (ядро программы), чтение файлов конфигурации и ответов и проверка их содержимого, создание JSON-объекта ответов. Подробно о функциях тестирования можно ознакомиться в [документации](./docs/ru/index.md). 

## Документация

Документацию пожно получить по [ссылке](./docs/ru/index.md), где приводится архитектура проекта и подробное описание классов.

## Лицензия

Этот класс лицензирован в соответствии с [MIT License](https://opensource.org/licenses/MIT).\
Copyright (c) 2025 Alexander Kazmirchuk

* * *

- Проект содержит копию библиотеки [nlohmann/json](https://github.com/nlohmann/json) Нильса Ломанна, лицензированную в соответствии с [MIT License](https://opensource.org/licenses/MIT).
- Также проект использует компоненты библиотеки [boost](https://www.boost.org), лицензированную в соответствии с [The Boost Software License](https://www.boost.org/users/license.html).
- Также проект использует библиотеку юнит-тестирования [GoogleTest](https://github.com/google/googletest/blob/main/README.md), лицензированную как [BSD 3-Clause "New" or "Revised" License](https://github.com/google/googletest/blob/main/LICENSE).

## Поддержка

Если у вас возникли сложности или вопросы по использованию программы или библиотеки, создайте 
[обсуждение](https://github.com/AVKazmirchuk/SearchEngine/issues/new) в данном репозитории или напишите на электронную почту <a_kazmirchuk@mail.ru>.



